# 結合テストチェックリスト

## case1 VEN 起動（パーティ登録 → レポート登録 → イベント取得 → oadrPoll）

- [ ] VTN に事前に共有された VEN 情報が登録されていること
- [ ] VTN にレポート情報が登録されていないこと
- [ ] VTN にイベントが登録されていないこと
- [ ] VTN に`oadrQueryRegistration`リクエストが送信されること

  - [ ] VTN が`oadrCreatedPartyRegistration`レスポンスを返すこと
    - [ ] レスポンスペイロードの`responseCode`が`200`であること
    - [ ] レスポンスペイロードに`vtnID`が含まれること
    - [ ] レスポンスペイロードの`oadrProfileName`が`2.0b`であること
    - [ ] レスポンスペイロードの`oadrTransportname`が`simpleHttp`であること
    - [ ] レスポンスペイロードに`venID`が含まれないこと
    - [ ] レスポンスペイロードに`registrationID`が含まれないこと
  - [ ] VTN に登録されている VEN 情報に`registrationID`が含まれないこと

- [ ] VTN に`oadrCreatePartyRegistration`リクエストが送信されること

  - [ ] VTN が`oadrCreatedPartyRegistration`レスポンスを返すこと
    - [ ] レスポンスペイロードの`responseCode`が`200`であること
    - [ ] レスポンスペイロードに`venID`が含まれること
    - [ ] レスポンスペイロードに`vtnID`が含まれること
    - [ ] レスポンスペイロードに`registrationID`が含まれていること
    - [ ] レスポンスペイロードの`oadrProfileName`が`2.0b`であること
    - [ ] レスポンスペイロードの`oadrTransportName`が`simpleHttp`であること
  - [ ] VTN に登録されている VEN 情報に以下の情報が含まれていること
    - [ ] `registrationID`: uuid 形式
    - [ ] `oadrProfilename`: `2.0b`
    - [ ] `oadrTransportName`: `simpleHttp`

- [ ] VTN に`oadrRegisterReport`リクエストが送信されること
- [ ] リクエストペイロードに``の情報が含まれていること
- [ ] リクエストペイロードに``の情報が含まれていること


  - [ ] VTN が`oadrRegisteredReport`レスポンスを返すこと
    - [ ] レスポンスペイロードの`responseCode`が`200`であること
    - [ ] レスポンスペイロードに`venID`が含まれること
    - [ ] レスポンスペイロードに`レポート`の`oadrReportRequest`が含まれること
    - [ ] `レポート`の`oadrReportRequest`が以下の情報を含むこと
      - [ ] `reportRequestID`: uuid 形式
      - [ ] `reportSpecifierID`: TODO: 事前に取り決めた ID
      - [ ] `granularity`: PT30M
      - [ ] `reportBackDuration`: P1D
      - [ ] `dtstart`: 現在時刻から次の 05:30（RFC3339 タイムゾーン UTC）
      - [ ] `duration`: PT30M
      - [ ] `rID`: TODO: 事前に取り決めた ID
      - [ ] `redingType`:TODO: ペイロードの内容を確認する
    - [ ] レスポンスペイロードに`レポート`の`oadrReportRequest`が含まれること
    - [ ] `レポート`の`oadrReportRequest`が以下の情報を含むこと
      - [ ] `reportRequestID`: uuid 形式
      - [ ] `reportSpecifierID`: TODO: 事前に取り決めた ID
      - [ ] `granularity`: PT30M
      - [ ] `reportBackDuration`: PT30M
      - [ ] `dtstart`: 現在時刻から次の 05 分または 35 分（RFC3339 タイムゾーン UTC）
      - [ ] `duration`: PT30M
      - [ ] `rID`: TODO: 事前に取り決めた ID
      - [ ] `redingType`:TODO: ペイロードの内容を確認する
  - [ ] VTN に受信した`レポート`の情報が登録されていること
  - [ ] 登録されている`レポート`情報に以下の情報が含まれていること
    - [ ] `reportRequestID`: uuid 形式
    - [ ] `granularity`: `PT30M`
    - [ ] `reportBackDuration`: `P1D`
    - [ ] `dtStart`:現在時刻から次の 05:30（RFC3339 タイムゾーン UTC）
    - [ ] `duration`: `PT30M`
    - [ ] `status`: `UPDATE`
    - [ ] `cancelQueued`: `FALSE`
    - [ ] `createQueued`: `FALSE`
  - [ ] VTN に受信した`レポート`の情報が登録されていること
  - [ ] 登録されている`レポート`情報に以下の情報が含まれていること
    - [ ] `reportRequestID`: uuid 形式
    - [ ] `granularity`: `PT30M`
    - [ ] `reportBackDuration`: `P1D`
    - [ ] `dtStart`:現在時刻から次の 05 分または 35 分（RFC3339 タイムゾーン UTC）
    - [ ] `duration`: `PT30M`
    - [ ] `status`: `UPDATE`
    - [ ] `cancelQueued`: `FALSE`
    - [ ] `createQueued`: `FALSE`

- [ ] VTN に`oadrCreatedReport`リクエストが送信されること
- [ ] リクエストペイロードの`responseCode`が`200`であること
- [ ] リクエストペイロードの`oadrPendingReports`に`レポート`の`reportRequestID`が含まれていること
- [ ] リクエストペイロードの`oadrPendingReports`に`レポート`の`reportRequestID`が含まれていること

  - [ ] VTN が`oadrResponse`レスポンスを返すこと
    - [ ] レスポンスペイロードの`responseCode`が`200`であること
    - [ ] レスポンスペイロードに`venID`が含まれること
  - [ ] 登録されている`レポート`情報の以下の項目が更新されていること
    - [ ] `status`: `SUBSCRIBE`

- [ ] VTN に`oadrRequestEvent`リクエストが送信されること

  - [ ] VTN が`oadrDistributeEvent`レスポンスを返すこと
    - [ ] レスポンスペイロードの`responseCode`が`200`であること
    - [ ] レスポンスペイロードに`vtnID`が含まれること
    - [ ] レスポンスペイロードに`oadrEvent`が含まれていないこと

- [ ] VTN に`oadrPoll`リクエストが送信されること
  - [ ] VTN が`oadrResponse`レスポンスを返すこと
    - [ ] レスポンスペイロードの`responseCode`が`200`であること
    - [ ] レスポンスペイロードに`venID`が含まれること
